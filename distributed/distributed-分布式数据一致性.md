---
title: 分布式数据一致性
date: 2018/8/30
categories:
- 分布式
tags:
- 分布式
---

### 参考
https://yq.aliyun.com/articles/582282

### 一致性可以分为强一致性与弱一致性
1. 强一致性  
  强一致性可以理解为在任意时刻，所有节点中的数据是一样的。同一时间点，你在节点A中获取到key1的值与在节点B中获取到key1的值应该都是一样的。  
  当更新操作完成之后，任何多个后续进程或者线程的访问都会返回最新的更新过的值。这种是对用户最友好的，就是用户上一次写什么，下一次就保证能读到什么。根据 CAP 理论，这种实现需要牺牲可用性。

2. 弱一致性  
系统并不保证后续进程或者线程的访问都会返回最新的更新过的值。系统在数据写入成功之后，不承诺立即可以读到最新写入的值，也不会具体的承诺多久之后可以读到。

3. 最终一致性  
弱一致性的特定形式。系统保证在没有后续更新的前提下，系统最终返回上一次更新操作的值。在没有故障发生的前提下，不一致窗口的时间主要受通信延迟，系统负载和复制副本的个数影响。DNS 是一个典型的最终一致性系统。  

### 微服务场景下的数据一致性解决方案
  解决方案有三种模式：事务模式、预约模式、补偿模式。  
1. 事务模式 -两阶段提交(2PC)

2. 预约模式 -TCC(Try-Confirm/Cancel)

3. 业务补偿模式

### CAP
  CAP是分布式系统的重要理论  
    一致性（Consistency）  
    高可用性（High-Availability）  
    分区可容忍性（Partition-tolerance）
      是设计者都希望能同时达到的，但是根据CAP理论一个系统最多能实现3中其2
